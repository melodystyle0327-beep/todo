# MongoDB Atlas 연결 문제 해결 가이드

## 문제: todos 데이터베이스가 MongoDB Compass에 보이지 않음

### 원인 분석

1. **MongoDB 데이터베이스는 첫 데이터가 저장될 때 자동 생성됩니다**
   - 빈 데이터베이스는 MongoDB Compass에 표시되지 않습니다
   - 최소 하나의 컬렉션에 최소 하나의 문서가 있어야 합니다

2. **.env 파일이 제대로 로드되지 않을 수 있습니다**
   - 서버가 로컬 MongoDB에 연결되어 있을 수 있습니다
   - 환경 변수가 제대로 주입되지 않았을 수 있습니다

3. **비밀번호 특수문자 인코딩 문제**
   - 비밀번호에 `*` 같은 특수문자가 있으면 URL 인코딩이 필요할 수 있습니다
   - `*`는 그대로 사용 가능하지만, 다른 특수문자는 인코딩 필요

### 해결 방법

#### 1단계: .env 파일 확인

`.env` 파일이 프로젝트 루트에 있고, 다음 형식인지 확인:
```
MONGO_URI=mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/todos
```

**주의사항:**
- `=` 앞뒤에 공백 없어야 함
- 따옴표 없어야 함
- 연결 문자열 끝에 `/todos` 포함 확인

#### 2단계: 서버 재시작

`.env` 파일을 수정했다면 반드시 서버를 재시작:
```bash
npm start
```

#### 3단계: 데이터 추가 테스트

서버가 실행 중일 때 할일을 하나 추가해보세요:
- 웹 브라우저에서 `http://localhost:5000` 접속
- 할일 추가 폼에 데이터 입력 후 제출
- 서버 터미널에 오류가 없는지 확인

#### 4단계: MongoDB Compass 새로고침

1. MongoDB Compass에서 `F5` 키를 누르거나 새로고침 버튼 클릭
2. `todos` 데이터베이스가 나타나는지 확인

#### 5단계: 연결 확인

서버 터미널에서 다음 메시지 확인:
- ✅ "연결 성공" → MongoDB Atlas 연결 성공
- ❌ "MongoDB 연결 실패" → 연결 문자열이나 네트워크 설정 확인 필요

### 비밀번호 특수문자 인코딩

비밀번호에 특수문자가 있다면 URL 인코딩이 필요할 수 있습니다:

| 문자 | 인코딩 |
|------|--------|
| `*` | `*` (인코딩 불필요) |
| `@` | `%40` |
| `#` | `%23` |
| `$` | `%24` |
| `%` | `%25` |
| `&` | `%26` |
| `+` | `%2B` |
| `=` | `%3D` |

**예시:**
```
비밀번호: as8623536*
연결 문자열: mongodb+srv://hplus365:as8623536*@cluster0.xxxxx.mongodb.net/todos
```

### MongoDB Atlas 네트워크 설정 확인

1. MongoDB Atlas 대시보드 접속
2. **Network Access** 메뉴 클릭
3. 현재 IP 주소가 화이트리스트에 있는지 확인
4. 없다면 `0.0.0.0/0` (모든 IP 허용) 추가

### 연결 테스트 스크립트 실행

다음 명령어로 연결 테스트:
```bash
node test-connection.js
```

이 스크립트는:
- .env 파일 로드 여부 확인
- MongoDB 연결 테스트
- 테스트 데이터 추가
- 데이터베이스 생성 확인

